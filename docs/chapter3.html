<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Results | jmvScaffold: R functions to develop jamovi modules</title>
  <meta name="description" content="It provise some explanations about using the package to develop jamovi modules" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Results | jmvScaffold: R functions to develop jamovi modules" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="It provise some explanations about using the package to develop jamovi modules" />
  <meta name="github-repo" content="mcfanda/jmvScaffold" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Results | jmvScaffold: R functions to develop jamovi modules" />
  
  <meta name="twitter:description" content="It provise some explanations about using the package to develop jamovi modules" />
  

<meta name="author" content="Marcello Gallucci" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interface.html"/>
<link rel="next" href="advanced-results-objects.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="mcstyle.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">jmvScaffold howto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="booklet.html"><a href="booklet.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="booklet.html"><a href="booklet.html#preface"><i class="fa fa-check"></i><b>1.1</b> Preface</a></li>
<li class="chapter" data-level="1.2" data-path="booklet.html"><a href="booklet.html#getstarted"><i class="fa fa-check"></i><b>1.2</b> Getting Started</a></li>
<li class="chapter" data-level="1.3" data-path="booklet.html"><a href="booklet.html#createmodule"><i class="fa fa-check"></i><b>1.3</b> Create a module</a></li>
<li class="chapter" data-level="1.4" data-path="booklet.html"><a href="booklet.html#defining-the-analysis"><i class="fa fa-check"></i><b>1.4</b> Defining the analysis</a></li>
<li class="chapter" data-level="1.5" data-path="booklet.html"><a href="booklet.html#jamovi-analysis"><i class="fa fa-check"></i><b>1.5</b> jamovi analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="interface.html"><a href="interface.html"><i class="fa fa-check"></i><b>2</b> Interface</a>
<ul>
<li class="chapter" data-level="2.1" data-path="interface.html"><a href="interface.html#options-.a.yaml"><i class="fa fa-check"></i><b>2.1</b> Options (.a.yaml)</a></li>
<li class="chapter" data-level="2.2" data-path="interface.html"><a href="interface.html#layout-.u.yaml"><i class="fa fa-check"></i><b>2.2</b> Layout (.u.yaml)</a></li>
<li class="chapter" data-level="2.3" data-path="interface.html"><a href="interface.html#compile"><i class="fa fa-check"></i><b>2.3</b> Compiling the jamovi module</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Results</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#preparing-the-results"><i class="fa fa-check"></i><b>3.1</b> Preparing the results</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#defining-the-result-tables-.r.yaml"><i class="fa fa-check"></i><b>3.2</b> Defining the result tables (.r.yaml)</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#r-code-for-jamovi"><i class="fa fa-check"></i><b>3.3</b> R code for jamovi</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#initialize-a-table"><i class="fa fa-check"></i><b>3.4</b> Initialize a table</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#populating-a-table"><i class="fa fa-check"></i><b>3.5</b> Populating a table</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#passing-data-to-smarttables"><i class="fa fa-check"></i><b>3.6</b> Passing data to SmartTables</a></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#automatic-filling-of-tables."><i class="fa fa-check"></i><b>3.7</b> Automatic filling of tables.</a></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#r6-classes-to-run-complex-modules"><i class="fa fa-check"></i><b>3.8</b> R6 classes to run complex modules</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html"><i class="fa fa-check"></i><b>4</b> Advanced Results Objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#groups-jmvcoregroup"><i class="fa fa-check"></i><b>4.2</b> Groups (jmvcore::Group)</a></li>
<li class="chapter" data-level="4.3" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#arrays-of-tables-jmvcorearray"><i class="fa fa-check"></i><b>4.3</b> Arrays of tables (jmvcore::Array)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#array-known-number-of-tables"><i class="fa fa-check"></i><b>4.3.1</b> Array: known number of tables</a></li>
<li class="chapter" data-level="4.3.2" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#array-unknown-number-of-tables"><i class="fa fa-check"></i><b>4.3.2</b> Array: Unknown number of tables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-results-objects.html"><a href="advanced-results-objects.html#other-results-objects"><i class="fa fa-check"></i><b>4.4</b> Other Results objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dynamic-tables-display.html"><a href="dynamic-tables-display.html"><i class="fa fa-check"></i><b>5</b> Dynamic Tables Display</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dynamic-tables-display.html"><a href="dynamic-tables-display.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="dynamic-tables-display.html"><a href="dynamic-tables-display.html#showing-table-on-options-change"><i class="fa fa-check"></i><b>5.2</b> Showing table on options change</a></li>
<li class="chapter" data-level="5.3" data-path="dynamic-tables-display.html"><a href="dynamic-tables-display.html#showing-tables-programmatically"><i class="fa fa-check"></i><b>5.3</b> Showing tables programmatically</a></li>
<li class="chapter" data-level="5.4" data-path="dynamic-tables-display.html"><a href="dynamic-tables-display.html#additional-strategies"><i class="fa fa-check"></i><b>5.4</b> Additional strategies</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html"><i class="fa fa-check"></i><b>6</b> Warning, Failing and Debuging</a>
<ul>
<li class="chapter" data-level="6.1" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#tables-debugging"><i class="fa fa-check"></i><b>6.2</b> Tables debugging</a></li>
<li class="chapter" data-level="6.3" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#mark-landmarks"><i class="fa fa-check"></i><b>6.3</b> Mark landmarks</a></li>
<li class="chapter" data-level="6.4" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#automatic-errors"><i class="fa fa-check"></i><b>6.4</b> Automatic Errors</a></li>
<li class="chapter" data-level="6.5" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#automatic-warnings"><i class="fa fa-check"></i><b>6.5</b> Automatic Warnings</a></li>
<li class="chapter" data-level="6.6" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#code-generated-warnings-and-messages"><i class="fa fa-check"></i><b>6.6</b> Code-generated Warnings and Messages</a></li>
<li class="chapter" data-level="6.7" data-path="warning-failing-and-debuging.html"><a href="warning-failing-and-debuging.html#transient-messages"><i class="fa fa-check"></i><b>6.7</b> Transient messages</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="formatting-tables.html"><a href="formatting-tables.html"><i class="fa fa-check"></i><b>7</b> Formatting Tables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="formatting-tables.html"><a href="formatting-tables.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="formatting-tables.html"><a href="formatting-tables.html#initializing-the-table"><i class="fa fa-check"></i><b>7.2</b> Initializing the table</a></li>
<li class="chapter" data-level="7.3" data-path="formatting-tables.html"><a href="formatting-tables.html#combining-below"><i class="fa fa-check"></i><b>7.3</b> Combining below</a></li>
<li class="chapter" data-level="7.4" data-path="formatting-tables.html"><a href="formatting-tables.html#add-spaces-between-rows"><i class="fa fa-check"></i><b>7.4</b> Add spaces between rows</a></li>
<li class="chapter" data-level="7.5" data-path="formatting-tables.html"><a href="formatting-tables.html#indent-some-row-value"><i class="fa fa-check"></i><b>7.5</b> Indent some row value</a></li>
<li class="chapter" data-level="7.6" data-path="formatting-tables.html"><a href="formatting-tables.html#showing-columns-when-needed"><i class="fa fa-check"></i><b>7.6</b> Showing columns when needed</a></li>
<li class="chapter" data-level="7.7" data-path="formatting-tables.html"><a href="formatting-tables.html#showing-columns-programmatically"><i class="fa fa-check"></i><b>7.7</b> Showing columns programmatically</a></li>
<li class="chapter" data-level="7.8" data-path="formatting-tables.html"><a href="formatting-tables.html#changing-column-names-programmatically"><i class="fa fa-check"></i><b>7.8</b> Changing column names programmatically</a></li>
<li class="chapter" data-level="7.9" data-path="formatting-tables.html"><a href="formatting-tables.html#super-titles"><i class="fa fa-check"></i><b>7.9</b> Super Titles</a></li>
<li class="chapter" data-level="7.10" data-path="formatting-tables.html"><a href="formatting-tables.html#something-else"><i class="fa fa-check"></i><b>7.10</b> Something else</a></li>
<li class="chapter" data-level="7.11" data-path="formatting-tables.html"><a href="formatting-tables.html#adding-columns-programmatically"><i class="fa fa-check"></i><b>7.11</b> Adding columns programmatically</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="smart-tables-update.html"><a href="smart-tables-update.html"><i class="fa fa-check"></i><b>8</b> Smart Tables Update</a>
<ul>
<li class="chapter" data-level="8.1" data-path="smart-tables-update.html"><a href="smart-tables-update.html#the-issue"><i class="fa fa-check"></i><b>8.1</b> The issue</a></li>
<li class="chapter" data-level="8.2" data-path="smart-tables-update.html"><a href="smart-tables-update.html#the-solution"><i class="fa fa-check"></i><b>8.2</b> The Solution</a></li>
<li class="chapter" data-level="8.3" data-path="smart-tables-update.html"><a href="smart-tables-update.html#bottom-line"><i class="fa fa-check"></i><b>8.3</b> Bottom line</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixa.html"><a href="appendixa.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">jmvScaffold: R functions to develop jamovi modules</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Results<a href="chapter3.html#chapter3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="preparing-the-results" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Preparing the results<a href="chapter3.html#preparing-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Results in <span class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span> are organized in tables (and some other widget types). Tables are
<a href='https://r6.r-lib.org/articles/Introduction.html' target='_blank'>R6 classes</a>
with many different properties and options, allowing the programmer to fine-tune the look and feel of the results in details. If you need actions not performed by <code>SmartTable</code> class, you can always twickle the jamovi tables as described in <a href='https://dev.jamovi.org/api_results-definition.html' target='_blank'>jamovi hub</a>.</p>
<p><code>jmvScaffold</code> provides a R6 class, named <code>SmartTables</code>, which works as an interface between the programmer and the jamovi results API. With that, you can do a lot of things without touching the jamovi results class. Before that, however, we need to declare our tables in the <code>.r.yaml</code> file. In our little project, we need at least one table for the regression results.</p>
<p>It is a good idea, I suggest, to see how the R table would look like. In R, we obtain the results of a linear regression with <code>lm()</code> command from <code>stats::</code> package, so we basically need to run this</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter3.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data will arrive from jamovi, here we fake one dataset</span></span>
<span id="cb12-2"><a href="chapter3.html#cb12-2" aria-hidden="true" tabindex="-1"></a> data     <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">50</span>),<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">50</span>))</span>
<span id="cb12-3"><a href="chapter3.html#cb12-3" aria-hidden="true" tabindex="-1"></a> model    <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data)</span>
<span id="cb12-4"><a href="chapter3.html#cb12-4" aria-hidden="true" tabindex="-1"></a>.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb12-5"><a href="chapter3.html#cb12-5" aria-hidden="true" tabindex="-1"></a> coeffs   <span class="ot">&lt;-</span> .summary<span class="sc">$</span>coefficients</span>
<span id="cb12-6"><a href="chapter3.html#cb12-6" aria-hidden="true" tabindex="-1"></a> coeffs</span></code></pre></div>
<pre><code>##                Estimate Std. Error    t value   Pr(&gt;|t|)
## (Intercept) -0.32222282  0.1330457 -2.4218963 0.01926648
## x           -0.02113883  0.1149572 -0.1838843 0.85487884</code></pre>
<p>Because we do not want spaces in the table heads, we can rename the table names and transform the table into a data.frame.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter3.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data will arrive from jamovi, here we fake one dataset</span></span>
<span id="cb14-2"><a href="chapter3.html#cb14-2" aria-hidden="true" tabindex="-1"></a> coeffs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coeffs)</span>
<span id="cb14-3"><a href="chapter3.html#cb14-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(coeffs)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;coef&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb14-4"><a href="chapter3.html#cb14-4" aria-hidden="true" tabindex="-1"></a> coeffs</span></code></pre></div>
<pre><code>##                    coef        se          t          p
## (Intercept) -0.32222282 0.1330457 -2.4218963 0.01926648
## x           -0.02113883 0.1149572 -0.1838843 0.85487884</code></pre>
<p>now that we know how our table will look like we should get into the R programming.</p>
<p>As a side note, I would suggest to always use R commands prefixed with their package name, such as <code>stats::lm</code> rather than <code>lm</code>. This is required if you want to publish your R module in CRAN, and it makes your code much more readable. It is like calling functions with their name and surname, and we want to be polite with our functions.</p>
</div>
<div id="defining-the-result-tables-.r.yaml" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Defining the result tables (.r.yaml)<a href="chapter3.html#defining-the-result-tables-.r.yaml" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All results tables (and other widgets) are defined in the <code>.r.yaml</code>. Here we need a table that will represent the R table we have seen before. So we need the following code.</p>
<div class="filename">
<span class="filename">File: jamovi/myregression.a.yaml (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/jamovi/myregression.a.yaml' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a href="chapter3.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb16-2"><a href="chapter3.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at">  myRegression</span></span>
<span id="cb16-3"><a href="chapter3.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Regression analysis</span></span>
<span id="cb16-4"><a href="chapter3.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">jrs</span><span class="kw">:</span><span class="at">   </span><span class="st">&#39;1.1&#39;</span></span>
<span id="cb16-5"><a href="chapter3.html#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="chapter3.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">items</span><span class="kw">:</span></span>
<span id="cb16-7"><a href="chapter3.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> coefficients</span></span>
<span id="cb16-8"><a href="chapter3.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">title</span><span class="kw">:</span><span class="at">  Parameter Estimates (Coefficients)</span></span>
<span id="cb16-9"><a href="chapter3.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Table</span></span>
<span id="cb16-10"><a href="chapter3.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">columns</span><span class="kw">:</span></span>
<span id="cb16-11"><a href="chapter3.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> var</span></span>
<span id="cb16-12"><a href="chapter3.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Variable&quot;</span></span>
<span id="cb16-13"><a href="chapter3.html#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> text</span></span>
<span id="cb16-14"><a href="chapter3.html#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> coef</span></span>
<span id="cb16-15"><a href="chapter3.html#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Estimate&quot;</span></span>
<span id="cb16-16"><a href="chapter3.html#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb16-17"><a href="chapter3.html#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> se</span></span>
<span id="cb16-18"><a href="chapter3.html#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> SE</span></span>
<span id="cb16-19"><a href="chapter3.html#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb16-20"><a href="chapter3.html#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> t</span></span>
<span id="cb16-21"><a href="chapter3.html#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;t&quot;</span></span>
<span id="cb16-22"><a href="chapter3.html#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb16-23"><a href="chapter3.html#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> zto</span></span>
<span id="cb16-24"><a href="chapter3.html#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> p</span></span>
<span id="cb16-25"><a href="chapter3.html#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;p&quot;</span></span>
<span id="cb16-26"><a href="chapter3.html#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb16-27"><a href="chapter3.html#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> zto,pvalue</span></span>
<span id="cb16-28"><a href="chapter3.html#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="chapter3.html#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>So, a widget of type <code>Table</code>, with columns defined by a <code>name</code>, a <code>title</code> and a <code>format</code>. Details of all widgets definitions can be found in the <a href='https://dev.jamovi.org/api_results-definition.html' target='_blank'>jamovi hub</a></p>
<p>Compiling the module (<a href="interface.html#compile">2.3</a>) after defining the table in the <code>.r.yaml</code> file produces the table in the output (still empty)</p>
<p><img src="pics/c3_output1.png" width="374" /></p>
</div>
<div id="r-code-for-jamovi" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> R code for jamovi<a href="chapter3.html#r-code-for-jamovi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we compiled our module, jamovi compiler produced two R files and put them in the <code>./R</code> folder.</p>
<p><img src="pics/c3_r_files.png" width="340" /></p>
<p>The <code>.h.R</code> file can be ignored, the jamovi compiler produces it every time we install the module. The important file is the <code>.b.R</code> file, where all the action takes place. The <code>.b.R</code> file contains a R6 class named <code>[analysisname]Class</code>, in our case <code>myRegressionClass</code>. The class contains (at least) two private functions, the <code>.init()</code> function and the <code>.run()</code> function. Those are the functions that we need to customize.</p>
<p>Before we dive into it, let’s spend two words about how jamovi process works.
When the user opens the analysis, or whenever the GUI is updated, jamovi runs your R module in the <code>.b.R</code> file. It calls the <code>.init()</code> function first and then the <code>.run()</code> function. Actually, the <code>.init()</code> function can be absent, but my suggestion is to define it for all analyses, because in the <code>.init()</code> function the tables are formated and prepared to be filled. The <code>.init()</code> function gives you the opportunity to give your output a nice and professional look. Tables are populated in the <code>.run()</code> function.</p>
<p>A working <code>.b.R</code> file, that does not do anything, is the following:</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter3.html#cb17-1" aria-hidden="true" tabindex="-1"></a>myRegressionClass <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&#39;jmvcore&#39;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb17-2"><a href="chapter3.html#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;myRegressionClass&quot;</span>,</span>
<span id="cb17-3"><a href="chapter3.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> myRegressionBase,</span>
<span id="cb17-4"><a href="chapter3.html#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb17-5"><a href="chapter3.html#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.init =</span> <span class="cf">function</span>() {</span>
<span id="cb17-6"><a href="chapter3.html#cb17-6" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-7"><a href="chapter3.html#cb17-7" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$data` contains the data</span></span>
<span id="cb17-8"><a href="chapter3.html#cb17-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$options` contains the options</span></span>
<span id="cb17-9"><a href="chapter3.html#cb17-9" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$results` contains the results object (to populate)</span></span>
<span id="cb17-10"><a href="chapter3.html#cb17-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-11"><a href="chapter3.html#cb17-11" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb17-12"><a href="chapter3.html#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">.run =</span> <span class="cf">function</span>() {</span>
<span id="cb17-13"><a href="chapter3.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="chapter3.html#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$data` contains the data</span></span>
<span id="cb17-15"><a href="chapter3.html#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$options` contains the options</span></span>
<span id="cb17-16"><a href="chapter3.html#cb17-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$results` contains the results object (to populate)</span></span>
<span id="cb17-17"><a href="chapter3.html#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="chapter3.html#cb17-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-19"><a href="chapter3.html#cb17-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-20"><a href="chapter3.html#cb17-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Here is where <code>jmvScaffold</code> comes handy. First, we want to be sure to have installed the jmvScaffold classes. To do that, in R we simply run this code (recall we did it in <a href="booklet.html#createmodule">1.3</a> installing the <code>jmvScaffold</code> R package)</p>
<div class="filename">
<span class="filename">File: an R file </span>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter3.html#cb18-1" aria-hidden="true" tabindex="-1"></a>jmvScaffold<span class="sc">::</span><span class="fu">copy_files</span>()</span></code></pre></div>
<p>which copies in the present module <code>./R</code> folder the necessary files.</p>
<p><img src="pics/c3_r_files2.png" width="334" /></p>
</div>
<div id="initialize-a-table" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Initialize a table<a href="chapter3.html#initialize-a-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Table objects are passed to the R package with the property <code>self$results</code>. This property is a <code>named list</code>, so we can refer to our table as <code>self$results$coefficients</code>. In the <code>.init()</code> function, we should create a <code>SmartTable</code> object initialized with the table it is going to handle. We simply write this code.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter3.html#cb19-1" aria-hidden="true" tabindex="-1"></a>myRegressionClass <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&#39;jmvcore&#39;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb19-2"><a href="chapter3.html#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;myRegressionClass&quot;</span>,</span>
<span id="cb19-3"><a href="chapter3.html#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> myRegressionBase,</span>
<span id="cb19-4"><a href="chapter3.html#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb19-5"><a href="chapter3.html#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.regtab=</span><span class="cn">NULL</span>,</span>
<span id="cb19-6"><a href="chapter3.html#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">.init =</span> <span class="cf">function</span>() {</span>
<span id="cb19-7"><a href="chapter3.html#cb19-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-8"><a href="chapter3.html#cb19-8" aria-hidden="true" tabindex="-1"></a>           private<span class="sc">$</span>.regtab<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>coefficients)</span>
<span id="cb19-9"><a href="chapter3.html#cb19-9" aria-hidden="true" tabindex="-1"></a>           private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">initTable</span>()</span>
<span id="cb19-10"><a href="chapter3.html#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="chapter3.html#cb19-11" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb19-12"><a href="chapter3.html#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">.run =</span> <span class="cf">function</span>() {</span>
<span id="cb19-13"><a href="chapter3.html#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="chapter3.html#cb19-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$data` contains the data</span></span>
<span id="cb19-15"><a href="chapter3.html#cb19-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$options` contains the options</span></span>
<span id="cb19-16"><a href="chapter3.html#cb19-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># `self$results` contains the results object (to populate)</span></span>
<span id="cb19-17"><a href="chapter3.html#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="chapter3.html#cb19-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-19"><a href="chapter3.html#cb19-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-20"><a href="chapter3.html#cb19-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>which defines a valilla <code>SmartTable</code>, it initializes it and saves it in a private variable <code>.regtab</code> for later use. At the moment, the initialization does not do anything, but creating the SmartTable object. The jamovi table associated with it has all the properties defined in the <code>r.yaml</code> file, but nothing more.</p>
</div>
<div id="populating-a-table" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Populating a table<a href="chapter3.html#populating-a-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can now populate the <code>coefficients</code> jamovi table by interacting with the <code>SmartTable</code> object in the <code>.run()</code> function.</p>
<p>First, we need to gather the user choices made in jamovi GUI by collecting the options we defined in the <code>.a.yalm file</code>. All options are available in R as a <code>named list</code> named <code>self$options</code>. So we can get them to define our regression models.</p>
<p>We should get the option <code>dep</code> to know which is our dependent variable, then we call the option <code>covs</code>. In the <code>.run()</code> function, we can write.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter3.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb20-2"><a href="chapter3.html#cb20-2" aria-hidden="true" tabindex="-1"></a>        .run <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb20-3"><a href="chapter3.html#cb20-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb20-4"><a href="chapter3.html#cb20-4" aria-hidden="true" tabindex="-1"></a>          dep   <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>dep</span>
<span id="cb20-5"><a href="chapter3.html#cb20-5" aria-hidden="true" tabindex="-1"></a>          covs  <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>covs</span>
<span id="cb20-6"><a href="chapter3.html#cb20-6" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb20-7"><a href="chapter3.html#cb20-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb20-8"><a href="chapter3.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p><code>dep</code> is a string containing the variable name, whereas <code>covs</code> is a list, so we need to manipulated it to make it a formula to pass it to <code>lm()</code>. This can be done easely with <code>jmvcore</code> R package, which provides very useful functions to handle the GUI input in R (see <a href='https://cran.r-project.org/web/packages/jmvcore/index.html' target='_blank'>jmvcore Package</a> for details). Here we use the function <code>jmvcore::composeFormula(dep,covs)</code>, which transforms a list of terms into a R formula.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter3.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb21-2"><a href="chapter3.html#cb21-2" aria-hidden="true" tabindex="-1"></a>        .run <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb21-3"><a href="chapter3.html#cb21-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb21-4"><a href="chapter3.html#cb21-4" aria-hidden="true" tabindex="-1"></a>          dep   <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>dep</span>
<span id="cb21-5"><a href="chapter3.html#cb21-5" aria-hidden="true" tabindex="-1"></a>          covs  <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>covs</span>
<span id="cb21-6"><a href="chapter3.html#cb21-6" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb21-7"><a href="chapter3.html#cb21-7" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(covs))</span>
<span id="cb21-8"><a href="chapter3.html#cb21-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb21-9"><a href="chapter3.html#cb21-9" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb21-10"><a href="chapter3.html#cb21-10" aria-hidden="true" tabindex="-1"></a>          formula <span class="ot">&lt;-</span> jmvcore<span class="sc">::</span><span class="fu">composeFormula</span>(dep,covs)</span>
<span id="cb21-11"><a href="chapter3.html#cb21-11" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb21-12"><a href="chapter3.html#cb21-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-13"><a href="chapter3.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>Notice the function <code>is.something()</code>. It is provided by <code>jmvScaffold</code> and it is useful to evaluate options, because options can be of very different classes, and we just want to know if they are set or not. <code>is.something</code> does that.</p>
<p>A this point, we should compute the regression and build a R table to pass to our <code>SmartTable</code> object defined before.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter3.html#cb22-1" aria-hidden="true" tabindex="-1"></a>myRegressionClass <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&#39;jmvcore&#39;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb22-2"><a href="chapter3.html#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;myRegressionClass&quot;</span>,</span>
<span id="cb22-3"><a href="chapter3.html#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> myRegressionBase,</span>
<span id="cb22-4"><a href="chapter3.html#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb22-5"><a href="chapter3.html#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.regtab=</span><span class="cn">NULL</span>,</span>
<span id="cb22-6"><a href="chapter3.html#cb22-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-7"><a href="chapter3.html#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">.init =</span> <span class="cf">function</span>() {</span>
<span id="cb22-8"><a href="chapter3.html#cb22-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-9"><a href="chapter3.html#cb22-9" aria-hidden="true" tabindex="-1"></a>           private<span class="sc">$</span>.regtab<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>coefficients)</span>
<span id="cb22-10"><a href="chapter3.html#cb22-10" aria-hidden="true" tabindex="-1"></a>           private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">initTable</span>()</span>
<span id="cb22-11"><a href="chapter3.html#cb22-11" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb22-12"><a href="chapter3.html#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">.run =</span> <span class="cf">function</span>() {</span>
<span id="cb22-13"><a href="chapter3.html#cb22-13" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb22-14"><a href="chapter3.html#cb22-14" aria-hidden="true" tabindex="-1"></a>            data     <span class="ot">&lt;-</span> self<span class="sc">$</span>data</span>
<span id="cb22-15"><a href="chapter3.html#cb22-15" aria-hidden="true" tabindex="-1"></a>            dep      <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>dep</span>
<span id="cb22-16"><a href="chapter3.html#cb22-16" aria-hidden="true" tabindex="-1"></a>            covs     <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>covs</span>
<span id="cb22-17"><a href="chapter3.html#cb22-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-18"><a href="chapter3.html#cb22-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(covs))</span>
<span id="cb22-19"><a href="chapter3.html#cb22-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb22-20"><a href="chapter3.html#cb22-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-21"><a href="chapter3.html#cb22-21" aria-hidden="true" tabindex="-1"></a>            formula  <span class="ot">&lt;-</span> jmvcore<span class="sc">::</span><span class="fu">composeFormula</span>(dep,covs)</span>
<span id="cb22-22"><a href="chapter3.html#cb22-22" aria-hidden="true" tabindex="-1"></a>            model    <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(formula,<span class="at">data=</span>data)</span>
<span id="cb22-23"><a href="chapter3.html#cb22-23" aria-hidden="true" tabindex="-1"></a>           .summary  <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb22-24"><a href="chapter3.html#cb22-24" aria-hidden="true" tabindex="-1"></a>            coeffs   <span class="ot">&lt;-</span> .summary<span class="sc">$</span>coefficients</span>
<span id="cb22-25"><a href="chapter3.html#cb22-25" aria-hidden="true" tabindex="-1"></a>            coeffs   <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(coeffs)</span>
<span id="cb22-26"><a href="chapter3.html#cb22-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">names</span>(coeffs)  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coef&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb22-27"><a href="chapter3.html#cb22-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-28"><a href="chapter3.html#cb22-28" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span>runSource <span class="ot">&lt;-</span> coeffs</span>
<span id="cb22-29"><a href="chapter3.html#cb22-29" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">runTable</span>()</span>
<span id="cb22-30"><a href="chapter3.html#cb22-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-31"><a href="chapter3.html#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="chapter3.html#cb22-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb22-33"><a href="chapter3.html#cb22-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-34"><a href="chapter3.html#cb22-34" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>(I use .foo notation for R variables that are named as primitives in R, but I guess this is not a good practice)</p>
<p>What matters here is that we have passed our result table <code>coeffs</code> to the <code>SmartTable</code> with the command <code>private$.regtab$runSource &lt;- coeffs</code> and we have told the table to update with the command <code>private$.regtab$runTable()</code>. We can now install the module in jamovi and check if it works. The rule is simple: every column in the jamovi table is populated with the data in the column with the same name in the R table.</p>
<p><img src="pics/c3_input1.png" width="585" /></p>
<p><img src="pics/c3_output2.png" width="339" /></p>
<p>It does work! However, the <code>Variable</code> column is empty. We want to fill it with the names of the covariates. So we simply add the code necessary to add a column to our R data.frame.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.1/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter3.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb23-2"><a href="chapter3.html#cb23-2" aria-hidden="true" tabindex="-1"></a>        .run <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb23-3"><a href="chapter3.html#cb23-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb23-4"><a href="chapter3.html#cb23-4" aria-hidden="true" tabindex="-1"></a>            data     <span class="ot">&lt;-</span> self<span class="sc">$</span>data</span>
<span id="cb23-5"><a href="chapter3.html#cb23-5" aria-hidden="true" tabindex="-1"></a>            dep      <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>dep</span>
<span id="cb23-6"><a href="chapter3.html#cb23-6" aria-hidden="true" tabindex="-1"></a>            covs     <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>covs</span>
<span id="cb23-7"><a href="chapter3.html#cb23-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-8"><a href="chapter3.html#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(covs))</span>
<span id="cb23-9"><a href="chapter3.html#cb23-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb23-10"><a href="chapter3.html#cb23-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-11"><a href="chapter3.html#cb23-11" aria-hidden="true" tabindex="-1"></a>            formula    <span class="ot">&lt;-</span> jmvcore<span class="sc">::</span><span class="fu">composeFormula</span>(dep,covs)</span>
<span id="cb23-12"><a href="chapter3.html#cb23-12" aria-hidden="true" tabindex="-1"></a>            model      <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(formula,<span class="at">data=</span>data)</span>
<span id="cb23-13"><a href="chapter3.html#cb23-13" aria-hidden="true" tabindex="-1"></a>            .summary   <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb23-14"><a href="chapter3.html#cb23-14" aria-hidden="true" tabindex="-1"></a>            coeffs     <span class="ot">&lt;-</span> .summary<span class="sc">$</span>coefficients</span>
<span id="cb23-15"><a href="chapter3.html#cb23-15" aria-hidden="true" tabindex="-1"></a>            coeffs     <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(coeffs)</span>
<span id="cb23-16"><a href="chapter3.html#cb23-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">names</span>(coeffs)  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coef&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb23-17"><a href="chapter3.html#cb23-17" aria-hidden="true" tabindex="-1"></a>            coeffs<span class="sc">$</span>var <span class="ot">&lt;-</span>  <span class="fu">rownames</span>(coeffs) </span>
<span id="cb23-18"><a href="chapter3.html#cb23-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-19"><a href="chapter3.html#cb23-19" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span>runSource <span class="ot">&lt;-</span> coeffs</span>
<span id="cb23-20"><a href="chapter3.html#cb23-20" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">runTable</span>()</span>
<span id="cb23-21"><a href="chapter3.html#cb23-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-22"><a href="chapter3.html#cb23-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-23"><a href="chapter3.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>We have now a decent table with the results.</p>
<p><img src="pics/c3_output3.png" width="413" /></p>
<p>It goes without saying that one can add any number of covariates, and the table will update automatically.</p>
<p><img src="pics/c3_output4.png" width="427" /></p>
</div>
<div id="passing-data-to-smarttables" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Passing data to SmartTables<a href="chapter3.html#passing-data-to-smarttables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>SmartTable</code> object accepts data to populate the jamovi table in several different formats, so one can use different strategies depending on their need.</p>
<ul>
<li>passing a data.frame to <code>$runSource</code></li>
<li>passing a function that returns a data.frame to <code>$runSource</code></li>
<li>passing a list of named lists, where each list represents a row and the names are the name of the columns</li>
<li>passing a function that returns a list of named lists</li>
<li>initializing the <code>SmartTable</code> with an R6 object (see later on for a detailed explanation)</li>
</ul>
<p>We can try these strategies (but the last) with some simple code, passing some numbers to our <code>coefficients</code> table.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R </span>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter3.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb24-2"><a href="chapter3.html#cb24-2" aria-hidden="true" tabindex="-1"></a>        .run <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb24-3"><a href="chapter3.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="chapter3.html#cb24-4" aria-hidden="true" tabindex="-1"></a>            <span class="do">## passing a function</span></span>
<span id="cb24-5"><a href="chapter3.html#cb24-5" aria-hidden="true" tabindex="-1"></a>            fun<span class="ot">&lt;-</span><span class="cf">function</span>()  {</span>
<span id="cb24-6"><a href="chapter3.html#cb24-6" aria-hidden="true" tabindex="-1"></a>                var<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)</span>
<span id="cb24-7"><a href="chapter3.html#cb24-7" aria-hidden="true" tabindex="-1"></a>                coef<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb24-8"><a href="chapter3.html#cb24-8" aria-hidden="true" tabindex="-1"></a>                se<span class="ot">=</span><span class="dv">4</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb24-9"><a href="chapter3.html#cb24-9" aria-hidden="true" tabindex="-1"></a>                t<span class="ot">=</span><span class="dv">7</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb24-10"><a href="chapter3.html#cb24-10" aria-hidden="true" tabindex="-1"></a>                p<span class="ot">=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb24-11"><a href="chapter3.html#cb24-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">data.frame</span>(var,coef,se,t,p))</span>
<span id="cb24-12"><a href="chapter3.html#cb24-12" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb24-13"><a href="chapter3.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="chapter3.html#cb24-14" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span>runSource <span class="ot">&lt;-</span> fun</span>
<span id="cb24-15"><a href="chapter3.html#cb24-15" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">runTable</span>()</span>
<span id="cb24-16"><a href="chapter3.html#cb24-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-17"><a href="chapter3.html#cb24-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-18"><a href="chapter3.html#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="chapter3.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p><img src="pics/c3_output5.png" width="365" /></p>
<div class="filename">
<span class="filename">File: R/myregression.b.R </span>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter3.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb25-2"><a href="chapter3.html#cb25-2" aria-hidden="true" tabindex="-1"></a>        .run <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb25-3"><a href="chapter3.html#cb25-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb25-4"><a href="chapter3.html#cb25-4" aria-hidden="true" tabindex="-1"></a>            <span class="do">## passing a list of named list</span></span>
<span id="cb25-5"><a href="chapter3.html#cb25-5" aria-hidden="true" tabindex="-1"></a>            alist<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb25-6"><a href="chapter3.html#cb25-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">var=</span><span class="st">&quot;x&quot;</span>,<span class="at">coef=</span><span class="dv">1</span>,<span class="at">se=</span><span class="dv">4</span>,<span class="at">t=</span><span class="dv">7</span>,<span class="at">p=</span><span class="dv">10</span>),</span>
<span id="cb25-7"><a href="chapter3.html#cb25-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">var=</span><span class="st">&quot;y&quot;</span>,<span class="at">coef=</span><span class="dv">2</span>,<span class="at">se=</span><span class="dv">5</span>,<span class="at">t=</span><span class="dv">8</span>,<span class="at">p=</span><span class="dv">11</span>),</span>
<span id="cb25-8"><a href="chapter3.html#cb25-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">var=</span><span class="st">&quot;z&quot;</span>,<span class="at">coef=</span><span class="dv">3</span>,<span class="at">se=</span><span class="dv">6</span>,<span class="at">t=</span><span class="dv">9</span>,<span class="at">p=</span><span class="dv">12</span>)</span>
<span id="cb25-9"><a href="chapter3.html#cb25-9" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-10"><a href="chapter3.html#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="chapter3.html#cb25-11" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span>runSource <span class="ot">&lt;-</span> alist</span>
<span id="cb25-12"><a href="chapter3.html#cb25-12" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">runTable</span>()</span>
<span id="cb25-13"><a href="chapter3.html#cb25-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-14"><a href="chapter3.html#cb25-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-15"><a href="chapter3.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p><img src="pics/c3_output6.png" width="375" /></p>
<p>The possibility to pass results to a SmartTable in different ways gives the programmer flexibility to populate tables from different sources. Nonetheless, when the module gets very complex, even this flexibility cannot be enough. When things get complex, the following method may be the best: Associating the table to a R6 class that it is automatically called by the tables themselves. Sound complex but it is not.</p>
</div>
<div id="automatic-filling-of-tables." class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Automatic filling of tables.<a href="chapter3.html#automatic-filling-of-tables." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can go a long way off without the following section. One can add tables and define a function or a procedure to fill each table, passing the results data to the <code>$runTable</code> function. However, when your module gets more complex, you want to give a structure to the calls that fill the tables, so you can forget about filling the table and focus on the R programming. Here comes the last method <code>jmvScaffold</code> offers to populate the <span class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span> tables.</p>
<p>When a <code>SmartTable</code> is initialized, it can be associated with an R6 class that provides the functions to run the table. When the table is run with the <code>$runTable()</code> function, it calls the R6 and inquires if the class has a function called <code>run_[tablename]</code>. If it is there, <code>run_[tablename]()</code> is executed and the table is filled with the return of the function.</p>
<p>Let’s build this R6 new class, and call it <code>Runner</code>.</p>
<div class="filename">
<span class="filename">File: R/Runner.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.2/R/Runner.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter3.html#cb26-1" aria-hidden="true" tabindex="-1"></a>Runner <span class="ot">&lt;-</span> R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb26-2"><a href="chapter3.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Runner&quot;</span>,</span>
<span id="cb26-3"><a href="chapter3.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">class=</span><span class="cn">TRUE</span>, </span>
<span id="cb26-4"><a href="chapter3.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cloneable=</span><span class="cn">FALSE</span>,</span>
<span id="cb26-5"><a href="chapter3.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">inherit =</span> Scaffold,</span>
<span id="cb26-6"><a href="chapter3.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">public=</span><span class="fu">list</span>(</span>
<span id="cb26-7"><a href="chapter3.html#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis=</span><span class="cn">NULL</span>,</span>
<span id="cb26-8"><a href="chapter3.html#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">initialize=</span><span class="cf">function</span>(obj) {</span>
<span id="cb26-9"><a href="chapter3.html#cb26-9" aria-hidden="true" tabindex="-1"></a>      self<span class="sc">$</span>analysis<span class="ot">&lt;-</span>obj</span>
<span id="cb26-10"><a href="chapter3.html#cb26-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb26-11"><a href="chapter3.html#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">run_coefficients=</span><span class="cf">function</span>() {  <span class="co"># this will be automatically called by SmartTable associated with the `coefficients` table</span></span>
<span id="cb26-12"><a href="chapter3.html#cb26-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-13"><a href="chapter3.html#cb26-13" aria-hidden="true" tabindex="-1"></a>      formula  <span class="ot">&lt;-</span> jmvcore<span class="sc">::</span><span class="fu">composeFormula</span>(self<span class="sc">$</span>analysis<span class="sc">$</span>options<span class="sc">$</span>dep,self<span class="sc">$</span>analysis<span class="sc">$</span>options<span class="sc">$</span>covs)</span>
<span id="cb26-14"><a href="chapter3.html#cb26-14" aria-hidden="true" tabindex="-1"></a>      model    <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(formula,<span class="at">data=</span>self<span class="sc">$</span>analysis<span class="sc">$</span>data)</span>
<span id="cb26-15"><a href="chapter3.html#cb26-15" aria-hidden="true" tabindex="-1"></a>     .summary  <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb26-16"><a href="chapter3.html#cb26-16" aria-hidden="true" tabindex="-1"></a>      coeffs   <span class="ot">&lt;-</span> .summary<span class="sc">$</span>coefficients</span>
<span id="cb26-17"><a href="chapter3.html#cb26-17" aria-hidden="true" tabindex="-1"></a>      coeffs   <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(coeffs)</span>
<span id="cb26-18"><a href="chapter3.html#cb26-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(coeffs)  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coef&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb26-19"><a href="chapter3.html#cb26-19" aria-hidden="true" tabindex="-1"></a>      coeffs<span class="sc">$</span>var <span class="ot">&lt;-</span>  <span class="fu">rownames</span>(coeffs) </span>
<span id="cb26-20"><a href="chapter3.html#cb26-20" aria-hidden="true" tabindex="-1"></a>      coeffs</span>
<span id="cb26-21"><a href="chapter3.html#cb26-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-22"><a href="chapter3.html#cb26-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># end of public</span></span>
<span id="cb26-23"><a href="chapter3.html#cb26-23" aria-hidden="true" tabindex="-1"></a>) <span class="co"># end of class</span></span></code></pre></div>
<p>What we are doing is to define a R6 object of class <code>Scaffold</code> (very useful in the future), that is initialized with <code>jmvcore::Analysis</code> R6 analysis object, in our case it will be the <code>myRegressionClass</code> object, that contains all information we need to do the analyses. We need to save it somewhere, so we store it in the <code>self$analysis</code> field. Alternatively, you can put it in the <code>private</code> fields (good practice), we did not do it to keep the code simpler. If you are worry about passing a big R6 class (the jamovi <code>myRegressionClass</code>) to another R6 class (<code>Runner</code>), don’t you worry: they are linked by reference, the memory footprint will not increase much (I guess).</p>
<p>Now we need to tell the <code>SmartTable</code> that it is is associated with this class. In the <code>myRegression.b.R</code> file we write:</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.2/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter3.html#cb27-1" aria-hidden="true" tabindex="-1"></a>myRegressionClass <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&#39;jmvcore&#39;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb27-2"><a href="chapter3.html#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;myRegressionClass&quot;</span>,</span>
<span id="cb27-3"><a href="chapter3.html#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> myRegressionBase,</span>
<span id="cb27-4"><a href="chapter3.html#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb27-5"><a href="chapter3.html#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.runner=</span><span class="cn">NULL</span>,</span>
<span id="cb27-6"><a href="chapter3.html#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">.regtab=</span><span class="cn">NULL</span>,</span>
<span id="cb27-7"><a href="chapter3.html#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">.init =</span> <span class="cf">function</span>() {</span>
<span id="cb27-8"><a href="chapter3.html#cb27-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-9"><a href="chapter3.html#cb27-9" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.runner<span class="ot">&lt;-</span>Runner<span class="sc">$</span><span class="fu">new</span>(self)</span>
<span id="cb27-10"><a href="chapter3.html#cb27-10" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>coefficients,private<span class="sc">$</span>.runner)</span>
<span id="cb27-11"><a href="chapter3.html#cb27-11" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">initTable</span>()</span>
<span id="cb27-12"><a href="chapter3.html#cb27-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-13"><a href="chapter3.html#cb27-13" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb27-14"><a href="chapter3.html#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">.run =</span> <span class="cf">function</span>() {</span>
<span id="cb27-15"><a href="chapter3.html#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="chapter3.html#cb27-16" aria-hidden="true" tabindex="-1"></a>            data     <span class="ot">&lt;-</span> self<span class="sc">$</span>data</span>
<span id="cb27-17"><a href="chapter3.html#cb27-17" aria-hidden="true" tabindex="-1"></a>            dep      <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>dep</span>
<span id="cb27-18"><a href="chapter3.html#cb27-18" aria-hidden="true" tabindex="-1"></a>            covs     <span class="ot">&lt;-</span> self<span class="sc">$</span>options<span class="sc">$</span>covs</span>
<span id="cb27-19"><a href="chapter3.html#cb27-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-20"><a href="chapter3.html#cb27-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(covs))</span>
<span id="cb27-21"><a href="chapter3.html#cb27-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb27-22"><a href="chapter3.html#cb27-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-23"><a href="chapter3.html#cb27-23" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.regtab<span class="sc">$</span><span class="fu">runTable</span>()</span>
<span id="cb27-24"><a href="chapter3.html#cb27-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-25"><a href="chapter3.html#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="chapter3.html#cb27-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-27"><a href="chapter3.html#cb27-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-28"><a href="chapter3.html#cb27-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>You can see that we simply initialize the <code>SmartTable</code> with a <code>Runner</code> R6 class, and in the <code>.run()</code> function of the <code>.b.R</code> file we execute the <code>$runTable()</code> function, which calls <code>run_coefficients</code> function in the runner. If it does not get anything, it would not populate the jamovi table. If the <code>run_coefficients</code> function returns some data, it fills the table with them.</p>
<p>Install the module (<a href="interface.html#compile">2.3</a>) and you get the expected results.</p>
<p><img src="pics/c3_output3.png" width="413" /></p>
<p>Pretty cool, I dare say. Instead, you might think that this strategy looks a bit complicated and not useful. If so, read on.</p>
</div>
<div id="r6-classes-to-run-complex-modules" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> R6 classes to run complex modules<a href="chapter3.html#r6-classes-to-run-complex-modules" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider now this case (but many more cases are coming). You have 2 tables to fill: regression coefficients, and a ANOVA table (think about keep adding tons of tables, the story would not change). You want to estimate the model only once, and then use the estimation object (an <code>lm</code> class in this case) for several different tables. We now do it for two tables.</p>
<p>In the <code>.r.yaml</code> file, we add:</p>
<div class="filename">
<span class="filename">File: jamovi/myregression.r.yaml (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/jamovi/myregression.r.yaml' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb28-1"><a href="chapter3.html#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="chapter3.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb28-3"><a href="chapter3.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> anova</span></span>
<span id="cb28-4"><a href="chapter3.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">title</span><span class="kw">:</span><span class="at">  ANOVA table</span></span>
<span id="cb28-5"><a href="chapter3.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Table</span></span>
<span id="cb28-6"><a href="chapter3.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">columns</span><span class="kw">:</span></span>
<span id="cb28-7"><a href="chapter3.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> var</span></span>
<span id="cb28-8"><a href="chapter3.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Variable&quot;</span></span>
<span id="cb28-9"><a href="chapter3.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> text</span></span>
<span id="cb28-10"><a href="chapter3.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> test</span></span>
<span id="cb28-11"><a href="chapter3.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;F-test&quot;</span></span>
<span id="cb28-12"><a href="chapter3.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb28-13"><a href="chapter3.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> zto</span></span>
<span id="cb28-14"><a href="chapter3.html#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> df1</span></span>
<span id="cb28-15"><a href="chapter3.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;df&quot;</span></span>
<span id="cb28-16"><a href="chapter3.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb28-17"><a href="chapter3.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> df2</span></span>
<span id="cb28-18"><a href="chapter3.html#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;dfres&quot;</span></span>
<span id="cb28-19"><a href="chapter3.html#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> intege</span></span>
<span id="cb28-20"><a href="chapter3.html#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> p</span></span>
<span id="cb28-21"><a href="chapter3.html#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;p&quot;</span></span>
<span id="cb28-22"><a href="chapter3.html#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb28-23"><a href="chapter3.html#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> zto,pvalue</span></span></code></pre></div>
<p>in the <code>Runner.R</code> R code file we add a function to estimate the model , and we define one function for each table to populate.</p>
<p>First, the estimating function.</p>
<div class="filename">
<span class="filename">File: R/Runner.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/R/Runner.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter3.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb29-2"><a href="chapter3.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">### we are in the public field of the Runner class</span></span>
<span id="cb29-3"><a href="chapter3.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="chapter3.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  public<span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb29-5"><a href="chapter3.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis=</span><span class="cn">NULL</span>,</span>
<span id="cb29-6"><a href="chapter3.html#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model=</span><span class="cn">NULL</span>,</span>
<span id="cb29-7"><a href="chapter3.html#cb29-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-8"><a href="chapter3.html#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">initialize=</span><span class="cf">function</span>(obj) {</span>
<span id="cb29-9"><a href="chapter3.html#cb29-9" aria-hidden="true" tabindex="-1"></a>      self<span class="sc">$</span>analysis<span class="ot">&lt;-</span>obj</span>
<span id="cb29-10"><a href="chapter3.html#cb29-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb29-11"><a href="chapter3.html#cb29-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-12"><a href="chapter3.html#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate=</span><span class="cf">function</span>() {</span>
<span id="cb29-13"><a href="chapter3.html#cb29-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-14"><a href="chapter3.html#cb29-14" aria-hidden="true" tabindex="-1"></a>      formula  <span class="ot">&lt;-</span> jmvcore<span class="sc">::</span><span class="fu">composeFormula</span>(self<span class="sc">$</span>analysis<span class="sc">$</span>options<span class="sc">$</span>dep,self<span class="sc">$</span>analysis<span class="sc">$</span>options<span class="sc">$</span>covs)</span>
<span id="cb29-15"><a href="chapter3.html#cb29-15" aria-hidden="true" tabindex="-1"></a>      self<span class="sc">$</span>model    <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(formula,<span class="at">data=</span>self<span class="sc">$</span>analysis<span class="sc">$</span>data)</span>
<span id="cb29-16"><a href="chapter3.html#cb29-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-17"><a href="chapter3.html#cb29-17" aria-hidden="true" tabindex="-1"></a>    }, </span>
<span id="cb29-18"><a href="chapter3.html#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>(again, for simplicity I put the model in a public field <code>self$model</code>, but putting it in <code>private$.model</code> is more elegant).</p>
<p>As regards filling the tables, we can do this:</p>
<div class="filename">
<span class="filename">File: R/Runner.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/R/Runner.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter3.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">### we are in the public field of the Runner class</span></span>
<span id="cb30-2"><a href="chapter3.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb30-3"><a href="chapter3.html#cb30-3" aria-hidden="true" tabindex="-1"></a>    run_coefficients<span class="ot">=</span><span class="cf">function</span>() {</span>
<span id="cb30-4"><a href="chapter3.html#cb30-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-5"><a href="chapter3.html#cb30-5" aria-hidden="true" tabindex="-1"></a>     .summary          <span class="ot">&lt;-</span>   <span class="fu">summary</span>(self<span class="sc">$</span>model)</span>
<span id="cb30-6"><a href="chapter3.html#cb30-6" aria-hidden="true" tabindex="-1"></a>      coeffs           <span class="ot">&lt;-</span>  .summary<span class="sc">$</span>coefficients</span>
<span id="cb30-7"><a href="chapter3.html#cb30-7" aria-hidden="true" tabindex="-1"></a>      coeffs           <span class="ot">&lt;-</span>   <span class="fu">as.data.frame</span>(coeffs)</span>
<span id="cb30-8"><a href="chapter3.html#cb30-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(coeffs)    <span class="ot">&lt;-</span>   <span class="fu">c</span>(<span class="st">&quot;coef&quot;</span>,<span class="st">&quot;se&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb30-9"><a href="chapter3.html#cb30-9" aria-hidden="true" tabindex="-1"></a>      coeffs<span class="sc">$</span>var       <span class="ot">&lt;-</span>   <span class="fu">rownames</span>(coeffs) </span>
<span id="cb30-10"><a href="chapter3.html#cb30-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(coeffs)</span>
<span id="cb30-11"><a href="chapter3.html#cb30-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb30-12"><a href="chapter3.html#cb30-12" aria-hidden="true" tabindex="-1"></a>    run_anova<span class="ot">=</span><span class="cf">function</span>() {</span>
<span id="cb30-13"><a href="chapter3.html#cb30-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-14"><a href="chapter3.html#cb30-14" aria-hidden="true" tabindex="-1"></a>      .anova          <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(car<span class="sc">::</span><span class="fu">Anova</span>(self<span class="sc">$</span>model,<span class="at">type=</span><span class="dv">3</span>))</span>
<span id="cb30-15"><a href="chapter3.html#cb30-15" aria-hidden="true" tabindex="-1"></a>       <span class="fu">names</span>(.anova)  <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;nothing&quot;</span>,<span class="st">&quot;df1&quot;</span>,<span class="st">&quot;test&quot;</span>,<span class="st">&quot;p&quot;</span>)</span>
<span id="cb30-16"><a href="chapter3.html#cb30-16" aria-hidden="true" tabindex="-1"></a>      .anova<span class="sc">$</span>df2      <span class="ot">&lt;-</span>  self<span class="sc">$</span>model<span class="sc">$</span>df.residual</span>
<span id="cb30-17"><a href="chapter3.html#cb30-17" aria-hidden="true" tabindex="-1"></a>      .anova<span class="sc">$</span>var      <span class="ot">&lt;-</span>  <span class="fu">rownames</span>(.anova)</span>
<span id="cb30-18"><a href="chapter3.html#cb30-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span>(.anova)</span>
<span id="cb30-19"><a href="chapter3.html#cb30-19" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb30-20"><a href="chapter3.html#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>Now we should program in the <code>myRegression.b.R</code> the new table <code>anova</code>.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter3.html#cb31-1" aria-hidden="true" tabindex="-1"></a>myRegressionClass <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&#39;jmvcore&#39;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) R6<span class="sc">::</span><span class="fu">R6Class</span>(</span>
<span id="cb31-2"><a href="chapter3.html#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;myRegressionClass&quot;</span>,</span>
<span id="cb31-3"><a href="chapter3.html#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> myRegressionBase,</span>
<span id="cb31-4"><a href="chapter3.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb31-5"><a href="chapter3.html#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">.runner=</span><span class="cn">NULL</span>,</span>
<span id="cb31-6"><a href="chapter3.html#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this is a list that contains all the SmartTables</span></span>
<span id="cb31-7"><a href="chapter3.html#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">.tables=</span><span class="fu">list</span>(),</span>
<span id="cb31-8"><a href="chapter3.html#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">.init =</span> <span class="cf">function</span>() {</span>
<span id="cb31-9"><a href="chapter3.html#cb31-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-10"><a href="chapter3.html#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(self<span class="sc">$</span>options<span class="sc">$</span>dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(self<span class="sc">$</span>options<span class="sc">$</span>covs))</span>
<span id="cb31-11"><a href="chapter3.html#cb31-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb31-12"><a href="chapter3.html#cb31-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># define the runner</span></span>
<span id="cb31-13"><a href="chapter3.html#cb31-13" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.runner<span class="ot">&lt;-</span>Runner<span class="sc">$</span><span class="fu">new</span>(self)</span>
<span id="cb31-14"><a href="chapter3.html#cb31-14" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-15"><a href="chapter3.html#cb31-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set up the coefficients SmartTable</span></span>
<span id="cb31-16"><a href="chapter3.html#cb31-16" aria-hidden="true" tabindex="-1"></a>            atable<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>coefficients,private<span class="sc">$</span>.runner)</span>
<span id="cb31-17"><a href="chapter3.html#cb31-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># put the SmartTable in the list</span></span>
<span id="cb31-18"><a href="chapter3.html#cb31-18" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.tables[[<span class="fu">length</span>(private<span class="sc">$</span>.tables)<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span>atable</span>
<span id="cb31-19"><a href="chapter3.html#cb31-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set up the anova SmartTable</span></span>
<span id="cb31-20"><a href="chapter3.html#cb31-20" aria-hidden="true" tabindex="-1"></a>            atable<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>anova,private<span class="sc">$</span>.runner)</span>
<span id="cb31-21"><a href="chapter3.html#cb31-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># put the SmartTable in the list</span></span>
<span id="cb31-22"><a href="chapter3.html#cb31-22" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.tables[[<span class="fu">length</span>(private<span class="sc">$</span>.tables)<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span>atable</span>
<span id="cb31-23"><a href="chapter3.html#cb31-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># init all tables</span></span>
<span id="cb31-24"><a href="chapter3.html#cb31-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lapply</span>(private<span class="sc">$</span>.tables,<span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">initTable</span>())</span>
<span id="cb31-25"><a href="chapter3.html#cb31-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-26"><a href="chapter3.html#cb31-26" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb31-27"><a href="chapter3.html#cb31-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">.run =</span> <span class="cf">function</span>() {</span>
<span id="cb31-28"><a href="chapter3.html#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="chapter3.html#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.something</span>(self<span class="sc">$</span>options<span class="sc">$</span>dep) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.something</span>(self<span class="sc">$</span>options<span class="sc">$</span>covs))</span>
<span id="cb31-30"><a href="chapter3.html#cb31-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>()</span>
<span id="cb31-31"><a href="chapter3.html#cb31-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># estimate the model             </span></span>
<span id="cb31-32"><a href="chapter3.html#cb31-32" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.runner<span class="sc">$</span><span class="fu">estimate</span>()</span>
<span id="cb31-33"><a href="chapter3.html#cb31-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># execute all SmartTable run functions             </span></span>
<span id="cb31-34"><a href="chapter3.html#cb31-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lapply</span>(private<span class="sc">$</span>.tables,<span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">runTable</span>())</span>
<span id="cb31-35"><a href="chapter3.html#cb31-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-36"><a href="chapter3.html#cb31-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb31-37"><a href="chapter3.html#cb31-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-38"><a href="chapter3.html#cb31-38" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>From now on, we can simply add results tables by defining each table in the <code>.r.yaml</code> file, define a function named <code>run_[tablename]</code> in the <code>Runner.R</code> file, and add the <code>SmartTable</code> to the <code>private$.tables</code> list. Pay attention to the fact that in the <code>.init()</code> function we define our smart object and then add them to a list. At the end, we run the <code>$initTable()</code> function for all objects in the list. The same we do in the <code>.run()</code> function executing the <code>$runTable()</code> function of each object. Later on, when we add additional tables, the last command (the <code>lappy(..)</code> command) should always appear after any definition of the tables.</p>
<p>Let’s do that with a new table, named <code>effectSizes</code> that would output some effect size indices (which will customize later on). First, the <code>.r.yaml</code>.</p>
<div class="filename">
<span class="filename">File: jamovi/myregression.r.yaml (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/jamovi/myregression.r.yaml' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a href="chapter3.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb32-2"><a href="chapter3.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> effects</span></span>
<span id="cb32-3"><a href="chapter3.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">title</span><span class="kw">:</span><span class="at">  Effect Size Indices</span></span>
<span id="cb32-4"><a href="chapter3.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Table</span></span>
<span id="cb32-5"><a href="chapter3.html#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="at">             </span><span class="fu">columns</span><span class="kw">:</span></span>
<span id="cb32-6"><a href="chapter3.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> var</span></span>
<span id="cb32-7"><a href="chapter3.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Variable&quot;</span></span>
<span id="cb32-8"><a href="chapter3.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> text</span></span>
<span id="cb32-9"><a href="chapter3.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> index</span></span>
<span id="cb32-10"><a href="chapter3.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Index&quot;</span></span>
<span id="cb32-11"><a href="chapter3.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> text</span></span>
<span id="cb32-12"><a href="chapter3.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb32-13"><a href="chapter3.html#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Value&quot;</span></span>
<span id="cb32-14"><a href="chapter3.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb32-15"><a href="chapter3.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="at">                      </span><span class="fu">format</span><span class="kw">:</span><span class="at"> zto</span></span>
<span id="cb32-16"><a href="chapter3.html#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="chapter3.html#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>This means we set up a jamovi table named <code>effects</code> with three columns, <code>var</code>, <code>index</code> and <code>value</code>. To fill it, we add in the <code>Runner</code> class a <code>run_effects()</code> function. There, we use the functions in <a href='https://cran.r-project.org/web/packages/effectsize/index.html' target='_blank'>R package effectsize</a> to compute the indices, so we need to add it in our DESCRIPTION file as an <code>Imports</code> (not shown here).</p>
<div class="filename">
<span class="filename">File: R/Runner.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/R/Runner.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter3.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span>
<span id="cb33-2"><a href="chapter3.html#cb33-2" aria-hidden="true" tabindex="-1"></a>    run_effects<span class="ot">=</span><span class="cf">function</span>() {</span>
<span id="cb33-3"><a href="chapter3.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="chapter3.html#cb33-4" aria-hidden="true" tabindex="-1"></a>      eps       <span class="ot">&lt;-</span>  effectsize<span class="sc">::</span><span class="fu">epsilon_squared</span>(self<span class="sc">$</span>model)</span>
<span id="cb33-5"><a href="chapter3.html#cb33-5" aria-hidden="true" tabindex="-1"></a>      eps_df    <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">var=</span>eps<span class="sc">$</span>Parameter,<span class="at">index=</span><span class="st">&quot;pEpsilon^2&quot;</span>,<span class="at">value=</span>eps<span class="sc">$</span>Epsilon2)</span>
<span id="cb33-6"><a href="chapter3.html#cb33-6" aria-hidden="true" tabindex="-1"></a>      eta       <span class="ot">&lt;-</span>  effectsize<span class="sc">::</span><span class="fu">eta_squared</span>(self<span class="sc">$</span>model)</span>
<span id="cb33-7"><a href="chapter3.html#cb33-7" aria-hidden="true" tabindex="-1"></a>      eta_df    <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">var=</span>eta<span class="sc">$</span>Parameter,<span class="at">index=</span><span class="st">&quot;pEta^2&quot;</span>,<span class="at">value=</span>eta<span class="sc">$</span>Eta2)</span>
<span id="cb33-8"><a href="chapter3.html#cb33-8" aria-hidden="true" tabindex="-1"></a>      omega     <span class="ot">&lt;-</span>  effectsize<span class="sc">::</span><span class="fu">omega_squared</span>(self<span class="sc">$</span>model)</span>
<span id="cb33-9"><a href="chapter3.html#cb33-9" aria-hidden="true" tabindex="-1"></a>      omega_df  <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">var=</span>eta<span class="sc">$</span>Parameter,<span class="at">index=</span><span class="st">&quot;pOmega^2&quot;</span>,<span class="at">value=</span>omega<span class="sc">$</span>Omega2)</span>
<span id="cb33-10"><a href="chapter3.html#cb33-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb33-11"><a href="chapter3.html#cb33-11" aria-hidden="true" tabindex="-1"></a>      tab       <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(eps_df,eta_df,omega_df)</span>
<span id="cb33-12"><a href="chapter3.html#cb33-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(tab)</span>
<span id="cb33-13"><a href="chapter3.html#cb33-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-14"><a href="chapter3.html#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#...#</span></span></code></pre></div>
<p>Now, we define the table as a <code>SmartTable</code> in the <code>.b.R</code> file and add it to the list of <code>SmartTable</code> objects we defined before.</p>
<div class="filename">
<span class="filename">File: R/myregression.b.R (<a href='https://github.com/mcfanda/COOLj/tree/Version.0.0.3/R/myregression.b.R' target='_blank'>Online version</a>)</span>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter3.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in the `.init()` function</span></span>
<span id="cb34-2"><a href="chapter3.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="chapter3.html#cb34-3" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set up the effects SmartTable</span></span>
<span id="cb34-4"><a href="chapter3.html#cb34-4" aria-hidden="true" tabindex="-1"></a>            atable<span class="ot">&lt;-</span>SmartTable<span class="sc">$</span><span class="fu">new</span>(self<span class="sc">$</span>results<span class="sc">$</span>effects,private<span class="sc">$</span>.runner)</span>
<span id="cb34-5"><a href="chapter3.html#cb34-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># put the SmartTable in the list</span></span>
<span id="cb34-6"><a href="chapter3.html#cb34-6" aria-hidden="true" tabindex="-1"></a>            private<span class="sc">$</span>.tables[[<span class="fu">length</span>(private<span class="sc">$</span>.tables)<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span>atable</span></code></pre></div>
<p>After installing the module, we should get the results as follows:</p>
<p><img src="pics/c3_output8.png" width="322" /></p>
<p>Aesthetically, the table can be improved, but the general idea of setting and populating tables should be now clear.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interface.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-results-objects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["jmvScaffoldHowto.pdf", "jmvScaffoldHowto.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
